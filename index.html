<!DOCTYPE HTML>
<!--
	Prepared by Bernard Tham for Wine Reviews Writer.
	Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html>
	<head>
		<title>Wine Reviews Writer</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body>

		<!-- Header -->
			<header id="header">
				<img src="images/Bottlewithtext.png" class="img" width="40" height="120" />
				<a href="index.html" class="logo" >Wine Reviews <strong>WRITER</strong></a>
				<nav>
					<a href="#menu">Menu</a>
				</nav>
			</header>

		<!-- Nav -->
			<nav id="menu">
				<ul class="links">
					<li><a href="index.html">Project Home</a></li>
					<li><a href="aboutme.html">About me</a></li>
					<li><a href="feedback.html">Feedback</a></li>
				</ul>
			</nav>

		<!-- Banner -->
			<section id="banner">
				<div class="inner">
					<h1>This is a website to publish my Capstone Project for GA DSI course 2017<br /> Still work in progress.....<br /></h1>
					<ul class="actions">
						<li><a href="#one" class="button alt scrolly big">Continue</a></li>
					</ul>
				</div>
			</section>

		<!-- One -->
			<article id="one" class="post style1">
				<div class="image">
					<video width="800" height="750" data-position="75% center" autoplay controls loop>
						<source src="video/winetextanimate1.m4v" type="video/mp4">
					Your browser does not support the video tag.
					</video>
					<!--img src="images/Title slide 2.png" alt="" data-position="75% center" /-->
				</div>
				<div class="content">
					<div class="inner">
						<header>
							<h3><a >Background</a></h3>

						</header>
						<p style="text-align:justify;">Wine has been produced for thousands of years. The earliest known winery is the 6100-year-old Areni-1 winery in Armenia. Throughout history, wine has been consumed for its intoxicating effects.

							Wine tasting is the sensory examination and evaluation of wine by experts. A wine sommelier, also known as "wine steward", is such a specialist wine expert in charge of developing a restaurant's wine list, and assisting customers with their selections (especially food-wine pairings). A wine critic is an expert and/or journalist who tastes and reviews wines for books and magazines. Wine producers would traditionally work closely with these professions in order to create the most appropriate or appealing wine reviews in order to entice customers to purchase their wines.

							I would like to help these wine producers analyse a dataset of wine reviews written by these Wine Enthusiasts,
							specifically to find out if the reviews reflect accurately the wine quality, its price and/or its variety - what are the typical descriptors used to identify highly priced wines, and
							also how to extract creative value from this huge library of wine reviews to create a review generator of our own.
						</p>

					</div>
					<div class="postnav">
						<a href="#" class="prev disabled"><span class="icon fa-chevron-up"></span></a>
						<a href="#two" class="scrolly next"><span class="icon fa-chevron-down"></span></a>
					</div>
				</div>
			</article>

		<!-- Two -->
			<article id="two" class="post invert style1 alt">
				<div class="image">
					<img src="images/Dataset.png" width="500" height="500" data-position="100% center" />
				</div>
				<div class="content">
					<div class="inner">
						<header>
							<h3><a >The data set</a></h3>

						</header>
						<p style="text-align:justify;"> This data set was obtained from Kaggle. It has only 11 columns to start with,
							many of them are location related info in text format. And only
              						2 columns with numeric data - price and points. Altogether there are > 150K rows in this data set, all with
							wine reviews.	Within the reviews text, there are > 6 M words.
							Lastly, there are > 13000 rows without price.</p>

					</div>
					<div class="postnav">
						<a href="#one" class="scrolly prev"><span class="icon fa-chevron-up"></span></a>
						<a href="#three" class="scrolly next"><span class="icon fa-chevron-down"></span></a>
					</div>
				</div>
			</article>

		<!-- Three -->
			<article id="three" class="post style2">
				<div class="image">
					<img src="images/Textreviewsamples.png" width="500" height="500" data-position="100% center" />
				</div>
				<div class="content">
					<div class="inner">
						<header>
							<h3><a >Samples of the review text corpus</a></h3>
						</header>
						<p style="text-align:justify;">As you can see from wine reviews on the right, the text is generally quite clean,
							with simple sentence structures, little to no connection between sentences in each document and
							hence little long-term dependencies. Only those words that contain diacritical marks
							need to be cleaned up. There are a number of them because many of the wineries are from Europe, and some
							French, German and Italian words use diacritical marks. In order to make my life easier, I used the
							Unidecode package to help me convert these special characters to Ascii characters since Python 2 only works
							with Ascii.</p>

					</div>
					<div class="postnav">
						<a href="#two" class="scrolly prev"><span class="icon fa-chevron-up"></span></a>
						<a href="#four" class="scrolly next"><span class="icon fa-chevron-down"></span></a>
					</div>
				</div>
			</article>

		<!-- Four -->
			<article id="four" class="post invert style2 alt">
				<div class="image" style="width: 1200px; height: 600px;">
					<img src="images/TextPreprocessingandModels.png" data-position="100% center" />
				</div>
				<div class="content">
					<div class="inner">
						<header>
							<h3><a >Workflow</a></h3>
						</header>
						<p style="text-align:justify;">As shown on the left, the work flow that I adopted to process the text corpus started with using Unidecode
						to convert those special characters into Ascii, followed by using the NLTK (Natural Language Tool Kit) package
						to find out the distribution of the most frequent words, and then using the VADER package to perform sentiment
						analysis on the text corpus. <br><br>
						Only after I had a better understanding of the word distribution and the sentiment analysis, then I proceeded to
						fit models to perform Regression on wine prices, and Classification of high or low prices as well as variety. Next, I
						used Word2Vec to extract contextual information and study the semantics of the words.
						</p>
					</div>
					<div class="postnav">
						<a href="#three" class="scrolly prev"><span class="icon fa-chevron-up"></span></a>
						<a href="#five" class="scrolly next"><span class="icon fa-chevron-down"></span></a>
					</div>
				</div>
			</article>

		<!-- Five -->
			<article id="five" class="post style3">
				<div class="image">
					<video width="800" height="750" data-position="75% center" controls loop>
						<source src="video/nltkvader.m4v" type="video/mp4">
					Your browser does not support the video tag.
					</video>
				</div>
				<div class="content">
					<div class="inner">
						<header>
							<h4><a>Word frequency distribution and sentiment analysis</a></h4>
						</header>
						<p style="text-align:justify;">We can see that the top 3 most frequently appearing words are "wine", "flavor" and "fruit". <br><br>
							The large majority of the reviews have either Positive or Neutral sentiment scores. Very few have negative
							scores. This is because only those reviews with points between 80 to 100 are provided in this dataset. Hence we have a text
							corpus that is pretty narrow in sentiment, and biased towards highly rated wines.
						</p>

					</div>
					<div class="postnav">
						<a href="#four" class="scrolly prev"><span class="icon fa-chevron-up"></span></a>
						<a href="#six" class="scrolly next"><span class="icon fa-chevron-down"></span></a>
					</div>
				</div>
			</article>

			<!-- Six -->
			<article id="six" class="post invert style3 alt">
				<div class="image">
					<video width="800" height="750" data-position="75% center" controls loop>
						<source src="video/Regression.m4v" type="video/mp4">
					Your browser does not support the video tag.
					</video>
				</div>
				<div class="content">
					<div class="inner">
						<header>
							<h4><a>Regression results</a></h4>
						</header>
						<p style="font-size:15px;text-align:justify;" >Now that we have a better understanding of the review text, let's try to put together all the
							features and try to predict the price of the wine. For the features of Country, Province, Variety,
							Winery, and Region, we can use Label Encoder and OneHotEncoder to convert them to dummy columns.<br>
							As for the Reviews column, we will use TFIDF to help us filter the words and retain significant
							words based on their frequency in the reviews as features and convert to word vectors.<br>
							For the choice of Regressors, we will use 4 Regressors - Lasso, Ridge, Random Forest and Gradient Boosting Regressor.
							Lasso and Ridge are powerful techniques generally used for creating parsimonious models in the presence of a ‘large’ number of features.
							Random Forest is an ensemble method that applies Bagging techniques to train multiple decision trees on different parts of the same training set, and averages them with the aim of reducing variance.
							Finally Gradient Boosting is an ensemble method that tries to fit subsequent models to the residuals of the last model in a sequential manner in order to reduce bias.
							These 4 regressors provide a good coverage of regularization, bagging and boosting techniques to help us better understand our results.<br><br>
							Among the 4 models, Grad Boosting gave the best accuracy scores (0.884). The regression models have shown that specific wineries (typically French and Italian), regions, a couple of varieties and points are positively correlated to wine prices and hence are good predictors of the higher ranges of prices.
							On the other hand, specific words like 'value', 'inexpensive', 'best buy' and 'bargain' are negatively correlated, and hence they are associated with the lower ranges of wine prices. If we think about it, what really determine/set the price of wines, should be famous wineries,
							their skill at wine-making, species of grapes, climactic conditions, techniques of fermenting, aging process, and bottling. Hence our finding makes a lot of sense.
						</p>

					</div>
					<div class="postnav">
						<a href="#four" class="scrolly prev"><span class="icon fa-chevron-up"></span></a>
						<a href="#six" class="scrolly next"><span class="icon fa-chevron-down"></span></a>
					</div>
				</div>
			</article>

			<!-- Seven -->
			<article id="seven" class="post style3">
				<div class="image">
					<video width="800" height="750" data-position="75% center" controls loop>
						<source src="video/Classification.m4v" type="video/mp4">
					Your browser does not support the video tag.
					</video>
				</div>
				<div class="content">
					<div class="inner">
						<header>
							<h4><a>Classification results</a></h4>
						</header>
						<p>
						</p>

					</div>
					<div class="postnav">
						<a href="#four" class="scrolly prev"><span class="icon fa-chevron-up"></span></a>
						<a href="#six" class="scrolly next"><span class="icon fa-chevron-down"></span></a>
					</div>
				</div>
			</article>


			<!-- Eight -->
			<article id="eight" class="post invert style3 alt">
				<div class="image">
					<img src="images/word2vec.png"  data-position="100% right" />
				</div>
				<div class="content">
					<div class="inner">
						<header>
							<h4><a>Word2Vec results</a></h4>
						</header>
						<p>
						</p>

					</div>
					<div class="postnav">
						<a href="#four" class="scrolly prev"><span class="icon fa-chevron-up"></span></a>
						<a href="#six" class="scrolly next"><span class="icon fa-chevron-down"></span></a>
					</div>
				</div>
			</article>

			<!-- Nine -->
			<article id="nine" class="post style3">
				<div class="image" style="width: 1000px; height: 600px;">
					<img src="images/ModelConfiguration.png"  data-position="100% left" />
				</div>
				<div class="content">
					<div class="inner">
						<header>
							<h4><a>Configuring our neural network</a></h4>
						</header>
						<p>
						</p>

					</div>
					<div class="postnav">
						<a href="#four" class="scrolly prev"><span class="icon fa-chevron-up"></span></a>
						<a href="#six" class="scrolly next"><span class="icon fa-chevron-down"></span></a>
					</div>
				</div>
			</article>

			<!-- Ten -->
			<article id="ten" class="post invert style3 alt">
				<div class="image">
					<video width="800" height="750" data-position="75% center"  controls loop>
						<source src="video/Chartoascii.m4v" type="video/mp4">
					Your browser does not support the video tag.
					</video>
				</div>
				<div class="content">
					<div class="inner">
						<header>
							<h3><a>Training with characters</a></h3>
						</header>
						<p style="text-align:justify;">In order to train a neural network on generating text, we have to think of how to provide input to it and how to interpret its output.
							We have to first break up each string of text of each document into individual characters, encode each character in Ascii code, and then
							One-Hot vectorize each Ascii encoded character. It is these One-Hot vectors that we input to the neural network, and it will produce
							an output that is also in this One-Hot vector form. Hence to decode it, we will have to reverse the process to convert it to Ascii code first, followed <body>
							identifying the character that matches the Ascii code.
							</body>

						</p>

					</div>
					<div class="postnav">
						<a href="#four" class="scrolly prev"><span class="icon fa-chevron-up"></span></a>
						<a href="#six" class="scrolly next"><span class="icon fa-chevron-down"></span></a>
					</div>
				</div>
			</article>

		<!-- Eleven -->
			<article id="eleven" class="post style3">
				<div class="image">
					<video width="750" height="700" data-position="75% center" controls loop>
						<source src="video/rnn_unfolding.m4v" type="video/mp4">
					Your browser does not support the video tag.
					</video>
				</div>
				<div class="content">
					<div class="inner">
						<header>
							<h3><a >Recurrent Neural Net Model Architecture</a></h3>
						</header>
						<p style="text-align:justify;">Each RNN unit takes in a One-Hot vector representing a character as input, concatenates with the previous state H<sub>t−1</sub>
							then goes through a series of computations by the reset and update gates and generates an output state. This RNN unfolds over
							the length of each sequence, taking in one character at a time, and at the end of each sequence, it predicts the next character
							after the end of that sequence. This predicted output is subjected to softmax computation to generate a probability, and the
							argmax of the highest probability gives the most likely character candidate. Accuracy is measured by the mean of cell-wise comparison
							between this predicted character vector with the actual label vector.</p>
					</div>
					<div class="postnav">
						<a href="#three" class="scrolly prev"><span class="icon fa-chevron-up"></span></a>
						<a href="#five" class="scrolly next"><span class="icon fa-chevron-down"></span></a>
					</div>
				</div>
			</article>

			<!-- Twelve -->
			<article id="twelve" class="post invert style3 alt">
				<div class="image">
					<video width="750" height="700" data-position="75% center" controls loop>
						<source src="video/trainingresults.m4v" type="video/mp4">
					Your browser does not support the video tag.
					</video>
				</div>
				<div class="content">
					<div class="inner">
						<header>
							<h3><a >Results of the training </a></h3>
						</header>
						<p>After 100 batches: <br>The neural net couldn't predict anything yet, and it was only able to generate gibberish text....<br><br>
						After 2500 batches: <br>Now it starts to predict some characters, and it's starting to learn the positions of the spaces. However, it's still not able to spell any English words.<br><br>
						After 10000 batches:<br>It's able to spell many English words correctly and it also learned title case. There are still many spelling mistakes though and
						it's hard to figure out what it's trying to express in each sentence.<br><br>
						After 50000 batches:<br>It's now able to spell most words correctly, even long words like "concentrated", it was consistently able to spell it correctly.
						</p>

					</div>
					<div class="postnav">
						<a href="#two" class="scrolly prev"><span class="icon fa-chevron-up"></span></a>
						<a href="#four" class="scrolly next"><span class="icon fa-chevron-down"></span></a>
					</div>
				</div>
			</article>

			<!-- Thirteen -->
			<article id="thirteen" class="post style2">
				<div class="image" style="width: 800px; height: 500px;" align="middle">
					<img src="images/finalslide.png"  style="image-resolution:1440dpi;"  data-position="100% middle" />
				</div>
				<div class="content">
					<div class="inner">
						<header>
							<h3><a >Conclusion and future work</a></h3>
						</header>
						<p style="text-align:left;">Overall, I'm pleased to see that my model is able to spell English words properly at the end, and also understands punctuation positions.
							Even the sentence structure is quite complete too. While the content of the text may be a little limited, this is after all largely dependent
							on the quality of the text corpus and I think it's not too bad for an initial attempt. Further processing and shaping of the text reviews is
							required to improve the quality of the text generation for sure.<br><br>
							Future work:
							<li style="text-align:left;">Increasing the input sequence length and/or number of hidden layers to improve accuracy.</li>
							<li style="text-align:left;">Using the Word2Vec model to create a word embedding layer to the RNN to generate word sequences instead of character sequences.</li>
							<li style="text-align:left;">Filter out those reviews with Positive sentiment scores to let the neural net learn only 'biased', but 'attractive' text reviews.</li>
							<li style="text-align:left;">Using the RNN with word embeddings layer to try to classify the 632 varieties of wine. </li>

						</p>

					</div>
					<div class="postnav">
						<a href="#five" class="scrolly prev"><span class="icon fa-chevron-up"></span></a>
						<a href="#" class="scrolly next disabled"><span class="icon fa-chevron-down"></span></a>
					</div>
				</div>
			</article>

		<!-- Footer -->
			<footer id="footer">
				<ul class="icons">
					<li><a href="http://linkedin.com/in/bernt73" class="icon fa-linkedin"><span class="label">LinkedIn</span></a></li>
					<li><a href="https://github.com/bernt73/Capstone-Project" class="icon fa-github"><span class="label">GitHub</span></a></li>
					<li><a href="mailto:bernt73@gmail.com" class="icon fa-envelope-o"><span class="label">Email</span></a></li>
				</ul>
				<div class="copyright">
					&copy; Created by Bernard - 2017
				</div>
			</footer>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
